<?xml version="1.0" encoding="UTF-8"?>
<precice-configuration>
  <!-- Scalar data definitions -->
  <data:scalar name="Heat-Transfer-Coefficient-Solid"/>
  <data:scalar name="Sink-Temperature-Solid"/>
  <data:scalar name="Heat-Transfer-Coefficient-Inner-Fluid"/>
  <data:scalar name="Sink-Temperature-Inner-Fluid"/>
  <data:scalar name="Heat-Transfer-Coefficient-Outer-Fluid"/>
  <data:scalar name="Sink-Temperature-Outer-Fluid"/>

  <!-- Mesh definitions with dimensions and naming conventions -->
  <mesh name="Solid-Inner-Fluid-Mesh" dimensions="3">
    <use-data name="Sink-Temperature-Solid"/>
    <use-data name="Heat-Transfer-Coefficient-Solid"/>
    <use-data name="Sink-Temperature-Inner-Fluid"/>
    <use-data name="Heat-Transfer-Coefficient-Inner-Fluid"/>
  </mesh>

  <mesh name="Solid-Outer-Fluid-Mesh" dimensions="3">
    <use-data name="Sink-Temperature-Solid"/>
    <use-data name="Heat-Transfer-Coefficient-Solid"/>
    <use-data name="Sink-Temperature-Outer-Fluid"/>
    <use-data name="Heat-Transfer-Coefficient-Outer-Fluid"/>
  </mesh>

  <mesh name="Inner-Fluid-Solid-Mesh" dimensions="3">
    <use-data name="Sink-Temperature-Inner-Fluid"/>
    <use-data name="Heat-Transfer-Coefficient-Inner-Fluid"/>
    <use-data name="Sink-Temperature-Solid"/>
    <use-data name="Heat-Transfer-Coefficient-Solid"/>
  </mesh>

  <mesh name="Outer-Fluid-Solid-Mesh" dimensions="3">
    <use-data name="Sink-Temperature-Outer-Fluid"/>
    <use-data name="Heat-Transfer-Coefficient-Outer-Fluid"/>
    <use-data name="Sink-Temperature-Solid"/>
    <use-data name="Heat-Transfer-Coefficient-Solid"/>
  </mesh>

  <!-- Participant definitions with updated mesh usage syntax and naming -->
  <participant name="Solid">
    <provide-mesh name="Solid-Inner-Fluid-Mesh"/>
    <receive-mesh name="Inner-Fluid-Solid-Mesh" from="Inner-Fluid"/>
    <write-data mesh="Solid-Inner-Fluid-Mesh" name="Sink-Temperature-Solid"/>
    <write-data mesh="Solid-Inner-Fluid-Mesh" name="Heat-Transfer-Coefficient-Solid"/>
    <read-data mesh="Solid-Inner-Fluid-Mesh" name="Sink-Temperature-Inner-Fluid"/>
    <read-data mesh="Solid-Inner-Fluid-Mesh" name="Heat-Transfer-Coefficient-Inner-Fluid"/>
    <mapping:nearest-neighbor constraint="consistent" direction="read"
             to="Solid-Inner-Fluid-Mesh" from="Inner-Fluid-Solid-Mesh"/>

    <provide-mesh name="Solid-Outer-Fluid-Mesh"/>
    <receive-mesh name="Outer-Fluid-Solid-Mesh" from="Outer-Fluid"/>
    <write-data mesh="Solid-Outer-Fluid-Mesh" name="Sink-Temperature-Solid"/>
    <write-data mesh="Solid-Outer-Fluid-Mesh" name="Heat-Transfer-Coefficient-Solid"/>
    <read-data mesh="Solid-Outer-Fluid-Mesh" name="Sink-Temperature-Outer-Fluid"/>
    <read-data mesh="Solid-Outer-Fluid-Mesh" name="Heat-Transfer-Coefficient-Outer-Fluid"/>
    <mapping:nearest-neighbor constraint="consistent" direction="read"
             to="Solid-Outer-Fluid-Mesh" from="Outer-Fluid-Solid-Mesh"/>
  </participant>

  <participant name="Inner-Fluid">
    <provide-mesh name="Inner-Fluid-Solid-Mesh"/>
    <receive-mesh name="Solid-Inner-Fluid-Mesh" from="Solid"/>
    <write-data mesh="Inner-Fluid-Solid-Mesh" name="Sink-Temperature-Inner-Fluid"/>
    <write-data mesh="Inner-Fluid-Solid-Mesh" name="Heat-Transfer-Coefficient-Inner-Fluid"/>
    <read-data mesh="Inner-Fluid-Solid-Mesh" name="Sink-Temperature-Solid"/>
    <read-data mesh="Inner-Fluid-Solid-Mesh" name="Heat-Transfer-Coefficient-Solid"/>
    <mapping:nearest-neighbor constraint="consistent" direction="read"
             to="Inner-Fluid-Solid-Mesh" from="Solid-Inner-Fluid-Mesh"/>
  </participant>

  <participant name="Outer-Fluid">
    <provide-mesh name="Outer-Fluid-Solid-Mesh"/>
    <receive-mesh name="Solid-Outer-Fluid-Mesh" from="Solid"/>
    <write-data mesh="Outer-Fluid-Solid-Mesh" name="Sink-Temperature-Outer-Fluid"/>
    <write-data mesh="Outer-Fluid-Solid-Mesh" name="Heat-Transfer-Coefficient-Outer-Fluid"/>
    <read-data mesh="Outer-Fluid-Solid-Mesh" name="Sink-Temperature-Solid"/>
    <read-data mesh="Outer-Fluid-Solid-Mesh" name="Heat-Transfer-Coefficient-Solid"/>
    <mapping:nearest-neighbor constraint="consistent" direction="read"
             to="Outer-Fluid-Solid-Mesh" from="Solid-Outer-Fluid-Mesh"/>
  </participant>

  <!-- Updated m2n:sockets with new attribute naming and directory conventions -->
  <m2n:sockets acceptor="Solid" connector="Inner-Fluid" exchange-directory=".."/>
  <m2n:sockets acceptor="Solid" connector="Outer-Fluid" exchange-directory=".."/>

  <coupling-scheme:multi>
    <participant name="Solid" control="yes"/>
    <participant name="Inner-Fluid"/>
    <participant name="Outer-Fluid"/>

    <!-- Renamed timestep-length and max-timesteps -->
    <time-window-size value="1e-3"/>
    <max-time-windows value="30"/>
    <max-iterations value="50"/>

    <relative-convergence-measure limit="1e-4" data="Sink-Temperature-Solid" mesh="Solid-Inner-Fluid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Heat-Transfer-Coefficient-Solid" mesh="Solid-Inner-Fluid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Sink-Temperature-Inner-Fluid" mesh="Inner-Fluid-Solid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Heat-Transfer-Coefficient-Inner-Fluid" mesh="Inner-Fluid-Solid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Sink-Temperature-Solid" mesh="Solid-Outer-Fluid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Heat-Transfer-Coefficient-Solid" mesh="Solid-Outer-Fluid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Sink-Temperature-Outer-Fluid" mesh="Outer-Fluid-Solid-Mesh"/>
    <relative-convergence-measure limit="1e-4" data="Heat-Transfer-Coefficient-Outer-Fluid" mesh="Outer-Fluid-Solid-Mesh"/>

    <!-- Removed extrapolation-order as it's no longer supported -->

    <exchange data="Sink-Temperature-Solid" mesh="Solid-Inner-Fluid-Mesh" from="Solid" to="Inner-Fluid" initialize="yes"/>
    <exchange data="Heat-Transfer-Coefficient-Solid" mesh="Solid-Inner-Fluid-Mesh" from="Solid" to="Inner-Fluid" initialize="yes"/>
    <exchange data="Sink-Temperature-Inner-Fluid" mesh="Inner-Fluid-Solid-Mesh" from="Inner-Fluid" to="Solid" initialize="yes"/>
    <exchange data="Heat-Transfer-Coefficient-Inner-Fluid" mesh="Inner-Fluid-Solid-Mesh" from="Inner-Fluid" to="Solid" initialize="yes"/>
    <exchange data="Sink-Temperature-Solid" mesh="Solid-Outer-Fluid-Mesh" from="Solid" to="Outer-Fluid" initialize="yes"/>
    <exchange data="Heat-Transfer-Coefficient-Solid" mesh="Solid-Outer-Fluid-Mesh" from="Solid" to="Outer-Fluid" initialize="yes"/>
    <exchange data="Sink-Temperature-Outer-Fluid" mesh="Outer-Fluid-Solid-Mesh" from="Outer-Fluid" to="Solid" initialize="yes"/>
    <exchange data="Heat-Transfer-Coefficient-Outer-Fluid" mesh="Outer-Fluid-Solid-Mesh" from="Outer-Fluid" to="Solid" initialize="yes"/>
  </coupling-scheme:multi>
</precice-configuration>
