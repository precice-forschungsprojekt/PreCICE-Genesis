<?xml version="1.0" encoding="UTF-8"?>
<precice-configuration>
  <!-- Removed <solver-interface> wrapper and moved its children up under <precice-configuration>. -->

  <!-- Data vector definitions remain unchanged. -->
  <data:vector name="Forces1"/>
  <data:vector name="Displacements1"/>
  <data:vector name="Forces2"/>
  <data:vector name="Displacements2"/>

  <!-- Updated mesh names: replaced underscores with hyphens and added dimensions="2". -->
  <mesh name="NASTIN1-Mesh" dimensions="2">
    <use-data name="Displacements1"/>
    <use-data name="Forces1"/>
  </mesh>

  <mesh name="SOLIDZ-Mesh1" dimensions="2">
    <use-data name="Displacements1"/>
    <use-data name="Forces1"/>
  </mesh>

  <mesh name="NASTIN2-Mesh" dimensions="2">
    <use-data name="Displacements2"/>
    <use-data name="Forces2"/>
  </mesh>

  <mesh name="SOLIDZ-Mesh2" dimensions="2">
    <use-data name="Displacements2"/>
    <use-data name="Forces2"/>
  </mesh>

  <participant name="NASTIN1">
    <!-- Replaced use-mesh with provide/receive syntax and updated mesh names. -->
    <receive-mesh name="SOLIDZ-Mesh1" from="SOLIDZ"/>
    <provide-mesh name="NASTIN1-Mesh"/>
    <write-data name="Forces1" mesh="NASTIN1-Mesh"/>
    <read-data name="Displacements1" mesh="NASTIN1-Mesh"/>
    <!-- Removed timing attributes from mapping tags. -->
    <mapping:nearest-neighbor 
         direction="write" 
         from="NASTIN1-Mesh" 
         to="SOLIDZ-Mesh1" 
         constraint="conservative"/>
    <mapping:nearest-neighbor 
         direction="read" 
         from="SOLIDZ-Mesh1" 
         to="NASTIN1-Mesh" 
         constraint="consistent"/>
  </participant>

  <participant name="NASTIN2">
    <!-- Replaced use-mesh with provide/receive syntax and updated mesh names. -->
    <receive-mesh name="SOLIDZ-Mesh2" from="SOLIDZ"/>
    <provide-mesh name="NASTIN2-Mesh"/>
    <write-data name="Forces2" mesh="NASTIN2-Mesh"/>
    <read-data name="Displacements2" mesh="NASTIN2-Mesh"/>
    <!-- Removed timing attributes from mapping tags. -->
    <mapping:nearest-neighbor 
         direction="write" 
         from="NASTIN2-Mesh" 
         to="SOLIDZ-Mesh2" 
         constraint="conservative"/>
    <mapping:nearest-neighbor 
         direction="read" 
         from="SOLIDZ-Mesh2" 
         to="NASTIN2-Mesh" 
         constraint="consistent"/>
  </participant>

  <participant name="SOLIDZ">
    <!-- Replaced use-mesh with provide-mesh and updated mesh names. -->
    <provide-mesh name="SOLIDZ-Mesh1"/>
    <write-data name="Displacements1" mesh="SOLIDZ-Mesh1"/>
    <read-data name="Forces1" mesh="SOLIDZ-Mesh1"/>
    <provide-mesh name="SOLIDZ-Mesh2"/>
    <write-data name="Displacements2" mesh="SOLIDZ-Mesh2"/>
    <read-data name="Forces2" mesh="SOLIDZ-Mesh2"/>
  </participant>

  <!-- Converted m2n:mpi to m2n:sockets with updated attributes and naming conventions. -->
  <m2n:sockets acceptor="NASTIN2" connector="SOLIDZ" exchange-directory="../"/>
  <m2n:sockets acceptor="NASTIN1" connector="SOLIDZ" exchange-directory="../"/>

  <coupling-scheme:multi>
    <participant name="NASTIN1"/>
    <participant name="NASTIN2"/>
    <participant name="SOLIDZ" control="yes"/>
    <!-- Renamed max-timesteps and timestep-length -->
    <max-time-windows value="200"/>
    <time-window-size value="1e-3"/>

    <!-- Updated exchanges with new mesh names -->
    <exchange data="Forces1" mesh="SOLIDZ-Mesh1" from="NASTIN1" to="SOLIDZ"/>
    <exchange data="Displacements1" mesh="SOLIDZ-Mesh1" from="SOLIDZ" to="NASTIN1"/>
    <exchange data="Forces2" mesh="SOLIDZ-Mesh2" from="NASTIN2" to="SOLIDZ"/>
    <exchange data="Displacements2" mesh="SOLIDZ-Mesh2" from="SOLIDZ" to="NASTIN2"/>

    <max-iterations value="30"/>
    <relative-convergence-measure limit="1e-4" data="Displacements1" mesh="SOLIDZ-Mesh1"/>
    <relative-convergence-measure limit="1e-4" data="Forces1" mesh="SOLIDZ-Mesh1"/>
    <relative-convergence-measure limit="1e-4" data="Displacements2" mesh="SOLIDZ-Mesh2"/>
    <relative-convergence-measure limit="1e-4" data="Forces2" mesh="SOLIDZ-Mesh2"/>

    <!-- Removed unsupported extrapolation-order element -->

    <!-- Renamed post-processing:IQN-ILS to acceleration:IQN-ILS and updated child element -->
    <acceleration:IQN-ILS>
      <data name="Displacements1" mesh="SOLIDZ-Mesh1"/>
      <data name="Forces1" mesh="SOLIDZ-Mesh1"/>
      <data name="Displacements2" mesh="SOLIDZ-Mesh2"/>
      <data name="Forces2" mesh="SOLIDZ-Mesh2"/>
      <preconditioner type="residual-sum"/>
      <filter type="QR1" limit="1e-6"/>
      <initial-relaxation value="0.1"/>
      <max-used-iterations value="100"/>
      <!-- Renamed timesteps-reused to time-windows-reused -->
      <time-windows-reused value="20"/>
    </acceleration:IQN-ILS>
  </coupling-scheme:multi>
</precice-configuration>
